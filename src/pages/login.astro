---
import PublicPageLayout from "@/layouts/PublicPageLayout.astro";
import { LoginForm } from "@/components/auth/LoginForm";
import { AuthSuccessMessage } from "@/components/auth/AuthSuccessMessage";

export const prerender = false;

// Get success message from query params
const url = new URL(Astro.request.url);
const messageType = url.searchParams.get("message");

const successMessages: Record<string, string> = {
  "password-reset-success": "Your password has been updated successfully. You can now sign in with your new password.",
};

const successMessage = messageType ? successMessages[messageType] : null;
---

<PublicPageLayout title="Sign in Â· StashTracker">
  <Fragment slot="hero">
    <p class="text-sm font-semibold uppercase tracking-[0.3em] text-primary/70">Welcome back</p>
    <h1 class="text-4xl font-semibold tracking-tight text-foreground md:text-5xl">Sign in to manage your stash</h1>
    <p class="text-base text-muted-foreground">
      Stay on top of your finances, budgets, and savings goals. Enter your credentials to access the dashboard.
    </p>
  </Fragment>

  {successMessage && <AuthSuccessMessage message={successMessage} client:load />}
  <LoginForm client:load />
</PublicPageLayout>
